<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OrderOps</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- 헤더 -->
    <header class="header">
      <div class="header-left">
        <h1 class="logo">
          <img src="favicon.png" alt="OrderOps Logo" class="logo-icon">
          OrderOps
        </h1>
      </div>
      <div class="header-right">
        <span class="date-display" id="currentDate"></span>
      </div>
    </header>

    <!-- 메인 컨텐츠 래퍼 -->
    <div class="main-wrapper">
      <!-- 좌측 사이드바 -->
      <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav">
          <button class="sidebar-item active" data-page="orders">
            <span class="sidebar-icon">📦</span>
            <span class="sidebar-text">주문 처리</span>
          </button>
          <button class="sidebar-item" data-page="shipping-fees">
            <span class="sidebar-icon">💰</span>
            <span class="sidebar-text">택배 운임비</span>
          </button>
        </nav>
      </aside>

      <!-- 메인 컨텐츠 -->
      <main class="main-content">
      <!-- 파일 업로드 섹션 -->
      <section class="upload-section">
        <div class="upload-area" id="uploadArea">
          <div class="upload-icon"></div>
          <h1>주문파일 업로드</h1>
          <p>스마트스토어에서 다운로드한 주문 CSV 파일만 드래그하거나 클릭하여 업로드할 수 있어요.</p>
          <p>
            CSV 파일로 변경하려면: 스마트스토어 주문 엑셀 파일을 연 뒤
            <strong>다른 이름으로 저장</strong> &gt; 파일 형식을
            <strong>CSV UTF-8(쉼표로 분리)</strong>로 선택해서 저장해주세요.
          </p>
          <input type="file" id="fileInput" accept=".csv" hidden>
          <button class="upload-btn" id="uploadBtn">파일 선택</button>
        </div>
        <div class="file-info" id="fileInfo" style="display: none;">
          <span class="file-name" id="fileName"></span>
          <button class="clear-btn" id="clearBtn">✕</button>
        </div>
      </section>

      <!-- 요약 카드 섹션 -->
      <section class="summary-section" id="summarySection" style="display: none;">
        <div class="summary-cards">
          <div class="summary-card">
            <div class="card-icon"></div>
            <div class="card-content">
              <span class="card-value" id="kyungdongCount">0</span>
              <span class="card-label">경동 (대박스/비닐)</span>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon"></div>
            <div class="card-content">
              <span class="card-value" id="logenCount">0</span>
              <span class="card-label">로젠 (소박스)</span>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon"></div>
            <div class="card-content">
              <span class="card-value" id="totalCustomers">0</span>
              <span class="card-label">수취인 수</span>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon"></div>
            <div class="card-content">
              <span class="card-value" id="giftOrders">0</span>
              <span class="card-label">사은품 대상</span>
            </div>
          </div>
        </div>
        <div class="notice-box">
          <h3>⚠️ 참고 안내사항</h3>
          <ul>
            <li>
              재단 요청(애견롤매트 4200445704) 및 마감재 요청(퍼즐매트)은 자동 감지되지만, 
              <strong>반드시 직접 확인</strong>해주세요.
            </li>
          </ul>
        </div>
      </section>

      <!-- 필터 섹션 -->
      <section class="filter-section" id="filterSection" style="display: none;">
        <div class="filter-group">
          <label>제품 유형</label>
          <select id="productTypeFilter">
            <option value="">전체</option>
            <option value="유아롤매트">유아 롤매트</option>
            <option value="애견롤매트">애견 롤매트</option>
            <option value="퍼즐매트">퍼즐매트</option>
          </select>
        </div>
        <div class="filter-group">
          <label>주문 상태</label>
          <select id="orderStatusFilter">
            <option value="">전체</option>
            <option value="발송대기">발송대기</option>
            <option value="배송중">배송중</option>
            <option value="배송완료">배송완료</option>
          </select>
        </div>
        <div class="filter-group">
          <label>사은품</label>
          <select id="giftFilter">
            <option value="">전체</option>
            <option value="있음">있음</option>
            <option value="없음">없음</option>
          </select>
        </div>
        <div class="filter-group search-group">
          <label>검색</label>
          <input type="text" id="searchInput" placeholder="주문번호, 고객명 검색...">
        </div>
      </section>

      <!-- 주문 테이블 섹션 -->
      <section class="orders-section" id="ordersSection" style="display: none;">
        <div class="section-header">
          <h2>주문 목록</h2>
          <div class="section-actions">
            <button class="action-btn" id="exportCombined1Btn">송장화 1</button>
            <button class="action-btn" id="exportCombined2Btn">송장화 2</button>
            <button class="action-btn" id="exportKyungdongFinalBtn">경동발주서(최종)</button>
            <button class="action-btn" id="exportLogenBtn">로젠 발주서</button>
            <button class="action-btn" id="exportShippingBtn">발송처리</button>
          </div>
        </div>
        
        <!-- 탭 버튼 컨테이너 -->
        <div class="tab-container">
          <!-- 그룹 1: 원본데이터 / 발송처리, 송장화 -->
          <button class="tab-btn active" data-tab="raw">원본 데이터</button>
          <button class="tab-btn" data-tab="shipping">발송처리</button>
          <button class="tab-btn" data-tab="combined1">송장화 1</button>
          <button class="tab-btn" data-tab="combined2">송장화 2</button>
          <div class="tab-divider"></div>
          <!-- 그룹 2: 경동류 -->
          <button class="tab-btn" data-tab="kyungdongFinal">경동발주서(최종)</button>
          <div class="tab-divider"></div>
          <!-- 그룹 3: 로젠류 -->
          <button class="tab-btn" data-tab="logen">로젠</button>
        </div>

        <div id="rawSection" class="content-section active">
          <div class="table-container">
            <table id="rawTable">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="rawTableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="shippingSection" class="content-section">
          <div class="table-container">
            <table id="shippingTable">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="shippingTableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="combined1Section" class="content-section">
          <div class="table-container">
            <table id="combined1Table">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="combined1TableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="combined2Section" class="content-section">
          <div class="table-container">
            <table id="combined2Table">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="combined2TableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="kyungdongFinalSection" class="content-section">
          <div class="table-container">
            <table id="kyungdongFinalTable">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="kyungdongFinalTableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="logenSection" class="content-section">
          <div class="table-container">
            <table id="logenTable">
              <thead>
                <!-- JS로 헤더 렌더링 -->
              </thead>
              <tbody id="logenTableBody">
                <!-- JS로 렌더링 -->
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- 택배 운임비 페이지 -->
      <section class="page-content" id="shippingFeesPage" style="display: none;">
        <div class="page-header">
          <h2>택배 운임비</h2>
        </div>
        <div class="missing-fee-notice">
          <p><strong>⚠️ 누락된 운임비 항목:</strong> 대박스 초과 및 합포장 운임비가 누락되어 있습니다. 담당자에게 확인하여 데이터를 채워주세요.</p>
        </div>
        <div class="table-container">
          <table id="shippingFeesTable">
            <thead>
              <tr>
                <th>순번</th>
                <th>제품군</th>
                <th>포장종류</th>
                <th>배송비</th>
                <th>폭(cm)</th>
                <th>두께(cm)</th>
                <th>길이 최소(m)</th>
                <th>길이 최대(m)</th>
                <th>비고</th>
              </tr>
            </thead>
            <tbody id="shippingFeesTableBody">
              <!-- JS로 렌더링 -->
            </tbody>
          </table>
        </div>
      </section>
    </main>
    </div>

    <!-- 주문 상세 모달 -->
    <div class="modal" id="orderModal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>주문 상세</h2>
          <button class="modal-close" id="modalClose">✕</button>
        </div>
        <div class="modal-body" id="modalBody">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>

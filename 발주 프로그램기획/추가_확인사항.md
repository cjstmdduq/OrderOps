# 발주 프로그램 개발 명세서

> 최종 수정일: 2025.12.16 (발주담당자 실제 데이터 반영)

---

## 1. 포장 및 박스 규격 정의

### 1-1. 롤매트: 두께별 포장 방식 결정 기준

> **로직**: 주문한 `폭`, `두께`, `길이`를 기준으로 **소박스(S) / 대박스(L) / 비닐** 중 자동 배정

| 두께 | 소박스 (S) | 대박스 (L) | 비닐포장 | 비고 |
|:---:|:---|:---|:---|:---|
| **6T** | ~8m | 8.5m~12m | 12.5m+ | 애견 전용 |
| **9T** | ~6m | 6.5m~10m | 10.5m+ | 애견 전용 |
| **12T** | ~3.5m | 4m~8m | 8.5m+ | 유아/애견 공용 |
| **17T** | ~3m | 3.5m~7m | **8m+** | 유아 전용 (실제 데이터) |
| **22T** | ~1m | 1.5m~3m | 3.5m+ | 유아 전용 |

> **⚠️ 실제 데이터**: 140폭 17T 8m → 비닐포장 + ★마킹

### 1-2. 퍼즐매트: 박스당 최대 수량

| 제품 종류 | 박스당 최대 포장 수량 | 비고 |
|:---|:---|:---|
| **25mm** | **최대 6장** | 6장 초과 시 박스 분할 |
| **40mm** | **최대 4장** | 4장 초과 시 박스 분할 |

---

## 2. 합포장(묶음배송) 처리 로직

### 2-1. 합포장 대상 조건
1. **동일 수취인** (이름, 주소, 연락처 일치)
2. **동일 제품군** 끼리만 가능 (롤매트↔롤매트 O / 퍼즐↔퍼즐 O / **롤↔퍼즐 X**)

### 2-2. 처리 규칙
- **개수 제한**: 없음 (가능한 모든 주문 건을 묶음)
- **두께 혼합**: 두께가 달라도 합포장 가능
- **포장재 변경**: 합포장으로 인해 규격 박스 용량 초과 시, **비닐** 포장으로 처리

### 2-3. 합포장 표기 (실제 데이터 기준)
- **비고에 `합` 표시**: 해당 라인은 다른 박스에 합포장됨
- **수취인명 `N-n` 형식**: N박스 중 n번째

---

## 3. 사은품 지급 로직

> **기준값**: 최종 결제 금액 (배송비 제외 상품 합계 금액 기준)

| 조건 (결제 금액) | 지급 품목 | 비고 |
|:---|:---|:---|
| **200,000원 이상** | **실리콘 테이프 (20m)** | |
| **300,000원 이상** | **발매트** | 라이브 방송 주문 건 식별 용도 |

---

## 4. 데이터 파싱 및 처리

### 4-1. 입력 데이터 (주문서) 매핑

> 스마트스토어 원본 → `발송처리` 시트

- **식별 정보**: `주문번호`, `상품주문번호`, `주문일시`
- **고객 정보**: `수취인명`, `수취인연락처1`, `주소(통합배송지)`
- **상품 정보**: `상품번호`, `상품명`, `옵션정보`
- **주문 정보**: `수량`, `최종 상품별 총 주문금액`, `주문상태`
- **기타**: `배송메세지`, `사은품`

### 4-2. 상품DB 매핑 (VLOOKUP)

> `상품DB(수정x)` 시트에서 상품번호로 조회

| 입력 | 출력 |
|------|------|
| 상품번호 | 디자인, 길이 |

예시: `(140)17T퓨어아이보리 8m` → 폭:140, 두께:17T, 디자인:퓨어아이보리, 길이:8m

### 4-3. 재단(Cutting) 요청 감지

> `배송메세지` 내 특정 키워드 포함 시 '재단 요청' 플래그 처리

**감지 키워드**:
- `재단`, `커팅`, `컷팅`, `절단`, `잘라`
- `사이즈`, `규격`, `크기`
- `가로`, `세로`, `폭`, `높이`, `길이`
- `cm`, `mm`

---

## 5. 수취인명 마킹 규칙 (실제 데이터 기준)

| 마킹 | 위치 | 의미 | 예시 |
|------|------|------|------|
| `★` | 이름 뒤 | 파손주의 (대형 롤) | `이주현★` |
| `N-n` | 이름 앞 | N박스 중 n번째 | `4-1나대남` |
| `합` | 비고 | 다른 박스에 합포장 | 비고: `합` |

---

## 6. 택배사별 출력 양식

### 6-1. 경동택배 (대형화물)
- **입력**: `송장화1` 시트
- **출력**: `경동발주서` 양식
- **필수 필드**: 받는분, 주소, 상세주소, 우편번호, 전화번호, 품목명, 수량, **포장상태**, 가로, 세로, 높이

### 6-2. 로젠택배 (일반택배)
- **입력**: `송장화2` 시트
- **출력**: `로젠` 양식
- **필수 필드**: 받는분, 전화번호, 우편번호, 주소, 운임타입, **디자인+수량**, 배송메세지

---

## 7. 개발 참고 및 제약 사항

- **재고 관리**: 현재 버전에서는 제외 (단순 발주 변환에 집중)
- **사용 환경**: PC (Windows/Mac) 단일 사용자 기준
- **예외 처리**:
  - 롤매트 폭이 140cm 이상인 경우 등의 특수 규격은 별도 로직 검토 필요
  - 주소가 완벽히 일치하지 않아도 동일인으로 간주할지 여부 (추후 보정 로직 필요)